---
name: skill-builder
description: 创建、扫描、Debug、迭代 Claude Code Skills 的管理智能体
---

# Skill 管理智能体

> 创建新 Skill / 扫描现有 Skills / Debug 后迭代更新

---

## 触发场景

| 用户意图 | 触发词 |
|----------|--------|
| 创建新 Skill | "帮我创建 Skill"、"沉淀成技能" |
| 扫描现有 Skills | "扫描我的 Skills"、"看看有哪些技能" |
| Debug 更新 | "这个 Skill 有问题"、"更新边界条件" |
| 批量优化 | "优化我的 Skills"、"检查所有技能" |

---

## 核心能力

```
┌─────────────────────────────────────────────────────────┐
│  1. 创建    引导用户从痛点到 Skill                       │
│  2. 扫描    读取现有 Skills，理解全局                    │
│  3. Debug   收集踩坑经验，更新边界条件                   │
│  4. 迭代    跨 Skills 持续优化                          │
└─────────────────────────────────────────────────────────┘
```

---

# 一、创建模式

## 轮次流程

### 第 1 轮：收集痛点

**你要问**：
```
你想解决什么问题？给我一个具体例子：
1. 你重复做过什么任务？
2. 每次你要重复说明什么？
3. 你期望的输出是什么样的？
```

### 第 2 轮：挖掘边界和踩坑

**目标**：主动引导用户说出边界条件和过往踩坑经验

**你要追问**：
```
让我挖一下这个任务的边界和坑：

【边界条件】
1. 什么情况下这个 Skill 应该触发？
2. 什么情况下不应该触发？（反例）
3. 输入有什么限制？（格式、大小、类型）
4. 输出有什么要求？（必须包含什么、不能包含什么）

【踩坑经验】
5. 你之前手动做这个任务时，踩过什么坑？
6. AI 之前帮你做时，犯过什么错？
7. 有没有"看起来对但其实不对"的情况？
8. 有没有容易遗漏的步骤或检查项？
```

**本轮输出**：
```
【边界条件】
- 触发条件：...
- 不触发条件：...
- 输入约束：...
- 输出约束：...

【踩坑清单】
- 坑1：... → 应对：...
- 坑2：... → 应对：...
```

### 第 3 轮：生成草稿

根据前两轮信息，生成包含边界和踩坑的 SKILL.md：

```markdown
---
name: {简短英文名}
description: {一句话描述}
---

# {Skill 名称}

## 触发场景
- {触发条件}
- **不触发**：{反例}

## 执行步骤
1. {步骤}
...

## 边界条件
- {输入约束}
- {输出约束}

## 踩坑清单
| 坑 | 表现 | 应对 |
|----|------|------|
| {坑名} | {现象} | {规避方法} |

## 约束条件
- {必须}
- {禁止}
```

### 第 4 轮：完善输出

整合反馈，保存到 `~/.claude/skills/{name}/SKILL.md`

---

# 二、扫描模式

## 触发

用户说"扫描 Skills"、"看看有哪些技能"

## 执行步骤

1. **扫描目录**
   ```bash
   # 扫描全局 Skills
   ls -la ~/.claude/skills/
   
   # 扫描项目 Skills（如果有）
   ls -la .claude/skills/
   ```

2. **读取每个 Skill 的 SKILL.md**
   - 提取 name, description
   - 提取触发场景
   - 提取边界条件和踩坑清单

3. **输出 Skills 清单**
   ```
   【全局 Skills】
   1. {name}: {description}
      - 触发：...
      - 边界：...
   
   2. {name}: {description}
      ...
   
   【项目 Skills】
   ...
   
   【覆盖情况】
   - 已覆盖场景：...
   - 可能缺失：...
   ```

---

# 三、Debug 模式

## 触发

用户说"这个 Skill 有问题"、"刚才出错了"、"更新边界条件"

## 执行步骤

### 步骤 1：定位问题 Skill

```
你刚才遇到了什么问题？
1. 是哪个 Skill 出的问题？（我可以帮你扫描）
2. 具体发生了什么？（描述现象）
3. 期望的行为是什么？
```

### 步骤 2：分析根因

```
让我分析一下这个问题的根因：

【问题分类】
□ 触发条件不准确（不该触发时触发了/该触发时没触发）
□ 边界条件缺失（没考虑到某种输入）
□ 步骤有遗漏（少了关键步骤）
□ 约束不够严格（做了不该做的事）
□ 输出格式问题（格式不符合预期）

你觉得是哪一类？
```

### 步骤 3：生成补丁

根据分析，生成 Skill 的更新补丁：

```
【更新位置】~/.claude/skills/{name}/SKILL.md

【新增边界条件】
- {新边界}

【新增踩坑记录】
| {坑名} | {现象} | {规避方法} |

【修改内容】
- 原文：...
- 改为：...
```

### 步骤 4：应用更新

确认后直接修改 SKILL.md 文件

---

# 四、迭代模式

## 触发

用户说"优化我的 Skills"、"检查所有技能"

## 执行步骤

1. **扫描所有 Skills**（调用扫描模式）

2. **交叉分析**
   ```
   【重复检测】
   - Skill A 和 Skill B 有重叠：...
   
   【缺口分析】
   - 场景 X 没有 Skill 覆盖
   
   【边界冲突】
   - Skill A 说要 XX，Skill B 说不要 XX
   
   【踩坑汇总】
   - 跨 Skill 的共性踩坑：...
   ```

3. **生成优化建议**
   ```
   【建议合并】
   - Skill A + B → 新 Skill C
   
   【建议拆分】
   - Skill D 太大 → D1 + D2
   
   【建议补充】
   - 新建 Skill E 覆盖场景 X
   
   【建议更新】
   - Skill F 增加边界条件：...
   ```

4. **用户确认后批量更新**

---

## 边界挖掘话术库

遇到用户回答不清楚时，用这些话术追问：

| 场景 | 追问话术 |
|------|----------|
| 边界不清 | "举个反例？什么情况下不应该这样做？" |
| 踩坑不明 | "上次 AI 帮你做时，哪里让你不满意？" |
| 输入模糊 | "如果输入是 XX 格式，应该怎么处理？" |
| 输出不确定 | "给我一个你满意的输出样例？" |
| 步骤遗漏 | "做完这步后，你一般还会检查什么？" |

---

## 踩坑分类模板

| 类型 | 典型表现 | 写入位置 |
|------|----------|----------|
| **触发类** | 不该触发时触发 | `## 触发场景 → 不触发` |
| **输入类** | 特殊输入导致错误 | `## 边界条件` |
| **步骤类** | 漏做关键步骤 | `## 执行步骤` |
| **输出类** | 格式/内容不对 | `## 输出格式` |
| **约束类** | 做了禁止的事 | `## 约束条件` |

---

## 脚本工具

### 快捷命令

```bash
# 脚本路径
SKILL_MANAGER="python3 ~/.claude/skills/skill-builder/scripts/skill-manager.py"

# 列出所有 Skills
$SKILL_MANAGER list -v

# 查看 Skill 详情
$SKILL_MANAGER show <skill-name>

# 创建新 Skill
$SKILL_MANAGER create <skill-name> -d "描述"

# 保存当前版本
$SKILL_MANAGER save <skill-name> "版本消息"

# 查看版本历史
$SKILL_MANAGER history <skill-name>

# 回滚到指定版本（1=最近）
$SKILL_MANAGER rollback <skill-name> <版本号>

# 对比两个版本
$SKILL_MANAGER diff <skill-name> 1 2
```

### Claude Commands

| 命令 | 作用 |
|------|------|
| `/skill-list` | 列出所有 Skills |
| `/skill-history <name>` | 查看版本历史 |
| `/skill-save <name> <msg>` | 保存当前版本 |

### 版本存储

版本保存在 `~/.claude/.skill-versions/<skill-name>/` 目录下，格式为 `YYYYMMDD_HHMMSS.md`

### 工作流程

```
修改前 → save 保存版本 → 编辑 SKILL.md → 测试 → 有问题 → rollback 回滚
                                          ↓
                                        满意 → save 保存新版本
```

---

## 其他工具

| 场景 | 调用 |
|------|------|
| 复杂分析 | Sequential Thinking |
| 记录踩坑 | Memory 持久化 |
| 读取 Skill | `cat ~/.claude/skills/{name}/SKILL.md` |

---

## 质量红线

- **不空想**：没有具体案例不生成
- **不遗漏**：必须追问边界和踩坑
- **不猜测**：不清楚就追问
- **不冗余**：每句话都有作用
- **不破坏**：更新前先确认

---

## 一句话总结

**Skill 管理智能体** = 创建 + 扫描 + Debug + 迭代

核心能力：
- **创建时**：挖掘边界条件和踩坑经验
- **使用后**：Debug 问题，更新 Skill
- **定期**：扫描全局，交叉优化

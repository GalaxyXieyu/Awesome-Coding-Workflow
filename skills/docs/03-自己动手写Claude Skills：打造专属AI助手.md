# Skills 完全指南

> 从零开始掌握 Claude Code Skills：是什么、怎么用、怎么开发。

---

## 一、为什么需要 Skills

使用 AI 编程助手时常见问题：

- **重复工作** - 每次都要重复说明相同的偏好和规范
- **上下文丢失** - 切换会话后之前的约定全部丢失
- **一致性问题** - 不同时间得到的输出格式/风格不一致

**Skills 的价值**：可复用的提示词模块，让 AI 能够执行特定领域任务、遵循固定流程、输出标准化结果。

---

## 二、Skills 是什么

### 三种类型

| 类型 | 说明 | 示例 |
|------|------|------|
| **流程型** | 定义多步骤执行过程 | 代码审查、数据库迁移、重构 |
| **约束型** | 定义行为规范和禁止项 | 代码风格、命名规范、安全约束 |
| **输出型** | 定义结果格式和模板 | 文档生成、报告输出、日志格式 |

### 目录结构

```
skill-name/
├── SKILL.md              # 大脑：核心定义文件
├── scripts/              # 双手：可执行脚本
├── references/           # 知识库：参考文档
└── assets/               # 工具箱：资源文件
```

### 核心定义文件 (SKILL.md)

告诉 AI **什么时候用** 和 **怎么用**：

```markdown
---
name: data-explorer
description: 自动探索企业数据库，生成数据质量报告
---

# 数据探索专家

## 触发场景
- 用户请求"分析数据"、"探索数据库"

## 执行步骤
1. 连接数据源
2. 执行探索脚本
3. 生成报告

## 约束条件
...
```

| 部分 | 作用 | 内容 |
|------|------|------|
| **YAML Header** | 让 AI 判断何时调用 | name, description |
| **Markdown Body** | 告诉 AI 如何执行 | 角色、步骤、约束 |

### 四个组件详解

| 组件 | 作用 | 示例 |
|------|------|------|
| **scripts/** | 弥补 AI 在精确计算、文件操作上的不足 | SQL 执行、PDF 解析、API 调用 |
| **references/** | 提供领域专业知识和项目上下文 | 数据库 Schema、API 文档、代码规范 |
| **assets/** | 生成输出物的模板和预设配置 | 代码模板、文档模板、配置文件 |

---

## 三、如何使用 Skills

### 存储位置

| 位置 | 路径 | 作用域 |
|------|------|--------|
| **全局 Skills** | `~/.claude/skills/` | 所有项目可用 |
| **项目 Skills** | `.claude/skills/` | 仅当前项目可用 |

### 导入方式

| 方式 | 适用场景 | 命令 |
|------|----------|------|
| 文件直接放置 | 最简单 | 复制到对应目录 |
| 符号链接 | 多项目共享 | `ln -s` |
| Git Submodule | 团队共享 | `git submodule add` |

### 引用语法

```markdown
# 在 Skill 中引用其他 Skill
@skill/data-exploration

# 在 Rules 中引用 Skill
@skill/data-validation
```

### 优先级规则

当全局和项目存在同名 Skill 时：
- **默认**：项目级优先
- **显式引用**：`@global/skill-name` 或 `@project/skill-name`

### Rules 联动

Skill 执行时会自动遵循 Rules 约束：

```
全局 Rules (~/.claude/rules/) > 项目 Rules (.claude/rules/) > Skill 内置约束
```

---

## 四、如何开发 Skills

### 核心理念

**Skill 让智能体从"会聊天"变成"能做事"**

### 开发思路

```
评估驱动 → 规模设计 → Claude视角 → 人机共创
```

### 1. 评估驱动开发

**从问题出发，而非空想功能**

在构建 Skill 之前，让智能体执行真实任务，观察失败点：

| 观察点 | Skill 设计价值 |
|--------|----------------|
| 出错位置 | 定位需要补充的知识 |
| 卡顿环节 | 发现缺失的上下文 |
| 重复提问 | 识别需要固化的决策 |

**小步验证原则**：先写简单版本验证可行性，多轮使用后逐步扩展。

### 2. 规模化设计

当 Skill 变得复杂时，采用三层架构：

| 层 | 内容量 | 作用 |
|----|--------|------|
| **元数据层** | ~100词 | 名称、简介、触发条件 |
| **正文层** | ~5000词 | 主要步骤、核心说明 |
| **附属层** | 按需加载 | 脚本、参考文档、模板 |

### 3. 从 Claude 视角思考

Claude 判断是否调用 Skill 时，主要依赖：**名称 + 简介**

> 一句准确的描述，决定了技能能否被正确使用

### 4. 人机共创迭代

- **成功时** → 让 Claude 总结有效做法，写回 Skill
- **失败时** → 让 Claude 反思错误原因，补充约束

### 快速识别 Skill 机会

问自己：
1. 这个任务我做过几次了？
2. 每次我都要重复说明什么？
3. 输出格式是否基本固定？
4. 是否有固定的执行步骤？

**如果有 2 个以上回答"是"**，就是一个好的 Skill 机会。

### 脚本封装决策

| 情况 | 是否封装 |
|------|----------|
| CLI 输出能直接给 AI 用 | 不封装 |
| CLI 输出需要"翻译"才能用 | 封装 |
| 需要状态管理、复杂错误处理 | 封装 |

---

## 五、设计模式（高级）

### 核心抽象

```
Skill = f(Context, Rules) → Output
```

一个 Skill 本质上是一个**受约束的函数**：输入上下文，受 Rules 约束，输出标准化结果。

### 三种模式

| 模式 | 特点 | 适用场景 |
|------|------|----------|
| **任务型** | 明确输入输出、固定步骤 | 代码生成、数据转换 |
| **流程型** | 多阶段、状态传递、条件分支 | 项目初始化、代码审查 |
| **智能体型** | 自主规划、动态策略 | 问题诊断、需求分析 |

### 抽象层级

| 层级 | 示例 | 说明 |
|------|------|------|
| Level 0 | 代码补全、文件读写 | 内置能力 |
| Level 1 | 函数提取、变量重命名 | 原子操作 |
| Level 2 | React 组件生成、SQL 优化 | 领域专业 |
| Level 3 | 全栈功能开发 | 多 Skill 组合 |

### 组合模式

| 模式 | 描述 | 适用 |
|------|------|------|
| **串行** | A → B → C | 流水线处理 |
| **并行** | 同时执行，结果聚合 | 多维度分析 |
| **条件** | 根据条件选择 | 分支处理 |

### 设计原则

1. **单一职责** - 每个 Skill 只做一件事
2. **可组合性** - 考虑与其他 Skill 的组合
3. **幂等性** - 相同输入产生相同输出
4. **可测试性** - 清晰的输入输出便于测试
5. **渐进增强** - 从简单开始，逐步增加复杂度

---

## 六、安全与评估

### 效果评估四维度

| 维度 | 核心指标 | 目标 |
|------|----------|------|
| 准确性 | 输出正确率、任务完成率 | >95%, >90% |
| 效率性 | 时间节省率、返工率 | >50%, <10% |
| 稳定性 | 一致性、错误率 | >98%, <2% |
| 可用性 | 首次使用成功率 | >90% |

### 安全风险等级

| 等级 | 特征 | 建议 |
|------|------|------|
| 低 | 仅 Markdown，无脚本 | 可直接使用 |
| 中 | 有脚本，仅本地操作 | 审查后使用 |
| 高 | 网络请求、文件写入 | 仔细审查+隔离测试 |
| 极高 | 需 root、修改系统配置 | 不建议使用 |

### 三条安全建议

1. **只安装可信来源** - 官方/知名开源/经过审计/自己编写
2. **使用前仔细阅读** - 检查脚本依赖、外部链接、文件操作
3. **理解执行逻辑** - 区分执行型代码和说明型代码

---

## 七、Skill 与 MCP 的关系

| 维度 | Skill | MCP |
|------|-------|-----|
| 提供 | 任务知识 | 外部连接 |
| 作用 | 教会如何完成工作 | 让 Claude 访问资源 |
| 类比 | 思维框架 | 行动手臂 |

**Skill(思维框架) + MCP(行动能力) = 混合式智能体**

---

## 八、一句话总结

**Skills** = 可复用的提示词模块，让 AI 从"会聊天"变成"能做事"。

核心价值：**能力提升 + 上下文扩展 + 知识沉淀**

开发心法：**评估驱动 → 小步验证 → 人机共创 → 持续迭代**
